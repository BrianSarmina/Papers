import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

qfi_4n_cyc_3p_non = np.array([[5.15840813,  0.00637222,  0.02085323],
  [ 0.00637222,  4.54038975, -0.01856945],
  [ 0.02085323, -0.01856945,  3.98394115]])

qfi_4n_cyc_3p_ent = np.array([[ 5.36271542e+00,  6.59412384e-02, -2.59700775e-03],
  [ 6.59412384e-02,  4.00639553e+00, -2.21155090e-01],
  [-2.59700775e-03, -2.21155090e-01,  3.98918354e+00]])

qfi_4n_cyc_6p_non = np.array([[ 5.33630573e+00,  3.17830658e-02, 2.15129089e-02,  8.70930099e-02,
   -1.98371124e-02,  1.08567089e+00],
  [ 3.17830658e-02,  5.37596542e+00,  2.46668167e-01,  1.84871826e-01,
   -1.80668526e-01, -2.67769279e-01],
  [ 2.15129089e-02,  2.46668167e-01,  4.57699017e+00, -2.28411674e-01,
    3.15494537e-03, -1.73531876e-01],
  [ 8.70930099e-02,  1.84871826e-01, -2.28411674e-01,  5.08460766e+00,
   -1.48583221e-02, -3.29562378e-02],
  [-1.98371124e-02, -1.80668526e-01,  3.15494537e-03, -1.48583221e-02,
    4.00102669e+00,  1.07742401e+00],
  [ 1.08567089e+00, -2.67769279e-01, -1.73531876e-01, -3.29562378e-02,
    1.07742401e+00,  7.20295822e+00]])

qfi_4n_cyc_6p_ent = np.array([[ 5.05244480e+00, -3.24592781e-01, -1.05230980e-01,  2.97729111e-02,
    8.29238892e-03,  2.54640999e+00],
  [-3.24592781e-01,  4.58159683e+00, -1.28322639e-01,  3.04314804e-02,
   -2.40042496e-01,  6.01454163e-02],
  [-1.05230980e-01, -1.28322639e-01,  3.79060070e+00, -1.14956436e-01,
   -1.06597748e-01,  1.78340912e-03],
  [ 2.97729111e-02,  3.04314804e-02, -1.14956436e-01,  4.05949810e+00,
   -1.37422791e-01, -7.80551147e-02],
  [ 8.29238892e-03, -2.40042496e-01, -1.06597748e-01, -1.37422791e-01,
    3.97919289e+00, -7.65333176e-02],
  [ 2.54640999e+00,  6.01454163e-02,  1.78340912e-03, -7.80551147e-02,
   -7.65333176e-02,  5.07492931e+00]])

qfi_4n_cyc_9p_non = np.array([[ 5.07004852e+00,  4.51326180e-01,  1.02533722e-02,  8.69689941e-03,
   -2.01945381e-01,  2.33239746e-02,  7.60829926e-03,  1.07161507e+00,
    5.94253197e-01],
  [ 4.51326180e-01,  5.07530140e+00,  2.03785896e-01, -5.12525940e-02,
   -1.33369026e-01,  3.41227226e-01,  1.37603989e-01, -2.01961517e-03,
   -6.61572647e-02],
  [ 1.02533722e-02,  2.03785896e-01,  4.93718113e+00, -1.17540550e-01,
    2.18998260e-01, -4.87163544e-02, -2.19768600e-01, -5.14033127e-02,
   -1.04946060e-01],
  [ 8.69689941e-03, -5.12525940e-02, -1.17540550e-01,  4.66681614e+00,
   -3.71950226e-01, -7.25069809e-02,  9.70905304e-03, -2.12152214e-01,
    1.61709442e-01],
  [-2.01945381e-01, -1.33369026e-01,  2.18998260e-01, -3.71950226e-01,
    4.44433922e+00, -8.61667633e-03, -4.30472946e-02, -2.35325699e-01,
    8.93928528e-03],
  [ 2.33239746e-02,  3.41227226e-01, -4.87163544e-02, -7.25069809e-02,
   -8.61667633e-03,  5.67869625e+00, -5.60594177e-02,  3.83021545e-02,
   -3.92441940e-02],
  [ 7.60829926e-03,  1.37603989e-01, -2.19768600e-01,  9.70905304e-03,
   -4.30472946e-02, -5.60594177e-02,  4.00286621e+00,  1.20976639e+00,
    1.26781311e-01],
  [ 1.07161507e+00, -2.01961517e-03, -5.14033127e-02, -2.12152214e-01,
   -2.35325699e-01,  3.83021545e-02,  1.20976639e+00,  6.66951767e+00,
    1.90729019e+00],
  [ 5.94253197e-01, -6.61572647e-02, -1.04946060e-01,  1.61709442e-01,
    8.93928528e-03, -3.92441940e-02,  1.26781311e-01,  1.90729019e+00,
    7.01541199e+00]])

qfi_4n_cyc_9p_ent = np.array([[ 4.97143585e+00, -1.44572449e-01, -2.28893967e-01, -9.01031494e-05,
    1.13381805e-01, -1.19014740e-03,  1.69879532e-02,  2.38666027e+00,
   -4.88877487e-02],
  [-1.44572449e-01,  4.67402107e+00,  6.26155090e-02, -8.33080673e-02,
    1.65341949e-02, -9.30122375e-03, -7.69454575e-02, -6.23465347e-02,
    1.99555634e+00],
  [-2.28893967e-01,  6.26155090e-02,  3.97139717e+00,  1.21973000e-01,
    2.62611771e-02,  1.29974365e-02, -7.82864761e-02, -2.09195175e-01,
    1.08700409e-01],
  [-9.01031494e-05, -8.33080673e-02,  1.21973000e-01,  3.95489212e+00,
    3.98979950e-02,  6.55095291e-02,  2.39719391e-02,  1.11820984e-02,
   -1.20070496e-01],
  [ 1.13381805e-01,  1.65341949e-02,  2.62611771e-02,  3.98979950e-02,
    3.99106712e+00,  6.98623657e-03,  1.25640106e-01, -2.91395187e-02,
    5.13716888e-02],
  [-1.19014740e-03, -9.30122375e-03,  1.29974365e-02,  6.55095291e-02,
    6.98623657e-03,  3.82746250e+00,  7.00630188e-03, -8.94974899e-02,
   -7.67662430e-02],
  [ 1.69879532e-02, -7.69454575e-02, -7.82864761e-02,  2.39719391e-02,
    1.25640106e-01,  7.00630188e-03,  4.00087440e+00, -1.42162437e-01,
    1.45878220e-02],
  [ 2.38666027e+00, -6.23465347e-02, -2.09195175e-01,  1.11820984e-02,
   -2.91395187e-02, -8.94974899e-02, -1.42162437e-01,  5.23524651e+00,
   -6.31439209e-03],
  [-4.88877487e-02,  1.99555634e+00,  1.08700409e-01, -1.20070496e-01,
    5.13716888e-02, -7.67662430e-02, 1.45878220e-02, -6.31439209e-03,
    4.33310207e+00]])


# Create a list of matrices and their titles
qfi_matrices = [qfi_4n_cyc_3p_non, qfi_4n_cyc_3p_ent, qfi_4n_cyc_6p_non, qfi_4n_cyc_6p_ent, qfi_4n_cyc_9p_non, qfi_4n_cyc_9p_ent]
titles = ['QFI 3p Non', 'QFI 3p Ent', 'QFI 6p Non', 'QFI 6p Ent', 'QFI 9p Non', 'QFI 9p Ent']

# Set up the figure and axes
fig, axes = plt.subplots(3, 2, figsize=(13, 10))

# Use a single color bar for all subplots
vmin = min([matrix.min() for matrix in qfi_matrices])
vmax = max([matrix.max() for matrix in qfi_matrices])

# Plot each matrix as a heatmap
for i, ax in enumerate(axes.flat):
    sns.heatmap(qfi_matrices[i], ax=ax, annot=True, cmap='crest', linewidth=0.5, vmin=vmin, vmax=vmax, cbar=i == 0,
                cbar_ax=None if i else fig.add_axes([.91, .3, .03, .4]))
    ax.set_title(titles[i])

# Adjust layout
plt.tight_layout(rect=[0, 0, .9, 1])
plt.show()

##plt.imshow(qfi_4n_cyc_6p_ent)
##data = np.array(qfi_4n_cyc_6p_ent, dtype='float16')
##for i in range(len(qfi_4n_cyc_6p_ent)):
##  for j in range(len(qfi_4n_cyc_6p_ent)):
##      plt.annotate(str(data[i][j]), xy=(j, i), ha='center', va='center', color='white')
##plt.colorbar()

#plt.show()

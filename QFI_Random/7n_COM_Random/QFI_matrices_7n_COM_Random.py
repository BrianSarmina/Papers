import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

qfi_7n_com_3p_non = np.array([[ 1.58744624e+01,  6.43856049e-03, -6.44210464e+00],
  [ 6.43856049e-03,  1.76900619e+01,  1.03080750e-03],
  [-6.44210464e+00,  1.03080750e-03,  2.10181297e+01]])

qfi_7n_com_3p_ent = np.array([[17.01203629,  0.09153202, -7.61818169],
  [ 0.09153202,  7.37398441, -0.31116093],
  [-7.61818169, -0.31116093, 20.93217285]])

qfi_7n_com_6p_non = np.array([[ 1.59963494e+01,  1.68228149e-05,  3.35175323e-02, -1.26750111e+00, -6.25400135e+00,  3.85788742e+00],
  [ 1.68228149e-05,  1.80214027e+01, -3.89420395e-01,  3.97380257e-01, 5.96952057e-01,  7.72289658e-02],
  [ 3.35175323e-02, -3.89420395e-01,  1.84715466e+01, -2.24533272e-01, -8.40591431e-03,  7.32181358e-01],
  [-1.26750111e+00,  3.97380257e-01, -2.24533272e-01,  1.67699503e+01, 7.28123894e-01, -7.52980843e-01],
  [-6.25400135e+00,  5.96952057e-01, -8.40591431e-03,  7.28123894e-01, 2.09396912e+01, -6.75620842e-01],
  [ 3.85788742e+00,  7.72289658e-02,  7.32181358e-01, -7.52980843e-01, -6.75620842e-01,  6.26432584e+01]])

qfi_7n_com_6p_ent = np.array([[ 1.72698076e+01, -1.24631004e-01,  2.46831818e-01,  9.75936127e-02, -6.55158543e+00,  1.58585221e+01],
  [-1.24631004e-01,  1.10905797e+01, -6.63769531e-02, -7.99212265e-02, -3.24820404e-01, -3.72205009e-01],
  [ 2.46831818e-01, -6.63769531e-02,  7.34590996e+00, -6.86698151e-02, -9.88104630e-02,  8.30954781e-01],
  [ 9.75936127e-02, -7.99212265e-02, -6.86698151e-02,  7.85045597e+00, 3.49448395e-02,  4.58073158e-01],
  [-6.55158543e+00, -3.24820404e-01, -9.88104630e-02,  3.49448395e-02, 2.10020381e+01, -6.22356758e+00],
  [ 1.58585221e+01, -3.72205009e-01,  8.30954781e-01,  4.58073158e-01, -6.22356758e+00,  6.27362177e+01]])

qfi_7n_com_9p_non = np.array([[ 1.62997482e+01,  8.16845779e-01,  7.17754173e-01, -3.84857559e-02,  7.05954285e-01, -9.76824188e-01, -6.68063820e+00,  3.04867962e+00,
   -1.17150642e+00],
  [ 8.16845779e-01,  1.73027570e+01,  2.14822876e+00, -1.56105042e-01,  -4.36248703e-01,  6.60454750e-01,  1.02182693e-01, -4.11127434e-01,
   -6.29966660e-01],
  [ 7.17754173e-01,  2.14822876e+00,  1.91166196e+01,  7.59744263e-01,  -2.86850281e-01,  3.73656387e-01, -2.94597816e-01, -1.25319435e+00,
   -1.93323120e+00],
  [-3.84857559e-02, -1.56105042e-01,  7.59744263e-01,  1.86763699e+01,  -3.21645584e-01,  7.84994431e-01,  4.21760559e-03, -3.67490234e-01,
    2.04454487e+00],
  [ 7.05954285e-01, -4.36248703e-01, -2.86850281e-01, -3.21645584e-01,  1.80605018e+01, -4.71947327e-01, -1.87280273e-01, -1.04682835e+00,
   -3.75914574e-01],
  [-9.76824188e-01,  6.60454750e-01,  3.73656387e-01,  7.84994431e-01,  -4.71947327e-01,  1.79474439e+01,  2.69499664e-01, -1.42125721e+00,
   -5.28046455e-01],
  [-6.68063820e+00,  1.02182693e-01, -2.94597816e-01,  4.21760559e-03,  -1.87280273e-01,  2.69499664e-01,  2.10767529e+01, -1.69829964e+00,
    1.74199902e+00],
  [ 3.04867962e+00, -4.11127434e-01, -1.25319435e+00, -3.67490234e-01,  -1.04682835e+00, -1.42125721e+00, -1.69829964e+00,  6.12994263e+01,
   -1.04626954e+01],
  [-1.17150642e+00, -6.29966660e-01, -1.93323120e+00,  2.04454487e+00,  -3.75914574e-01, -5.28046455e-01,  1.74199902e+00, -1.04626954e+01,
    7.00328534e+01]])

qfi_7n_com_9p_ent = np.arrary([[1.90646869e+01, -7.79838257e-01, -2.37170067e-01, -2.41487846e-01,  7.11612701e-02,  2.03210068e-02, -6.97088634e+00,  1.72476240e+01,
    3.00817463e+00],
  [-7.79838257e-01,  1.08205490e+01, -8.31989288e-03, -3.18125534e-01,  -1.02307510e-02,  1.40305939e-01,  2.09728622e-02,  6.07592392e-02,
    5.77149651e+00],
  [-2.37170067e-01, -8.31989288e-03,  9.50536560e+00, -1.34948692e-01,  2.62971115e-02, -1.21160660e-01,  2.82105637e-01, -1.04813766e+00,
   -4.27445869e-01],
  [-2.41487846e-01, -3.18125534e-01, -1.34948692e-01,  7.56736446e+00,  2.49254608e-02, -8.64850998e-02,  5.36349869e-01,  8.14741135e-02,
   -5.21873741e-01],
  [ 7.11612701e-02, -1.02307510e-02,  2.62971115e-02,  2.49254608e-02,  8.27198185e+00, -1.16442528e-01,  9.97914124e-02,  2.32399406e-01,
    1.42164154e-01],
  [ 2.03210068e-02,  1.40305939e-01, -1.21160660e-01, -8.64850998e-02,  -1.16442528e-01,  7.36787582e+00, -6.79119492e-02,  1.42154388e-01,
    1.03389587e-01],
  [-6.97088634e+00,  2.09728622e-02,  2.82105637e-01,  5.36349869e-01,  9.97914124e-02, -6.79119492e-02,  2.10993729e+01, -7.78698280e+00,
   -1.53604385e+00],
  [ 1.72476240e+01,  6.07592392e-02, -1.04813766e+00,  8.14741135e-02,  2.32399406e-01,  1.42154388e-01, -7.78698280e+00,  6.58518772e+01,
    6.80752892e+00],
  [ 3.00817463e+00,  5.77149651e+00, -4.27445869e-01, -5.21873741e-01,  1.42164154e-01,  1.03389587e-01, -1.53604385e+00,  6.80752892e+00,
    4.08948115e+01]])


# Create a list of matrices and their titles
qfi_matrices = [qfi_7n_com_3p_non, qfi_7n_com_3p_ent, qfi_7n_com_6p_non, qfi_7n_com_6p_ent, qfi_7n_com_9p_non, qfi_7n_com_9p_ent]
titles = ['QFI 3p Non', 'QFI 3p Ent', 'QFI 6p Non', 'QFI 6p Ent', 'QFI 9p Non', 'QFI 9p Ent']

# Set up the figure and axes
fig, axes = plt.subplots(3, 2, figsize=(13, 10))

# Use a single color bar for all subplots
vmin = min([matrix.min() for matrix in qfi_matrices])
vmax = max([matrix.max() for matrix in qfi_matrices])

# Plot each matrix as a heatmap
for i, ax in enumerate(axes.flat):
    sns.heatmap(qfi_matrices[i], ax=ax, annot=True, cmap='crest', linewidth=0.5, vmin=vmin, vmax=vmax, cbar=i == 0,
                cbar_ax=None if i else fig.add_axes([.91, .3, .03, .4]))
    ax.set_title(titles[i])

# Adjust layout
plt.tight_layout(rect=[0, 0, .9, 1])
plt.show()

##plt.imshow(qfi_4n_cyc_6p_ent)
##data = np.array(qfi_4n_cyc_6p_ent, dtype='float16')
##for i in range(len(qfi_4n_cyc_6p_ent)):
##  for j in range(len(qfi_4n_cyc_6p_ent)):
##      plt.annotate(str(data[i][j]), xy=(j, i), ha='center', va='center', color='white')
##plt.colorbar()

#plt.show()

import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

qfi_7n_com_3p_CYC_ENT = np.array([[ 1.67715275e+01, -1.82219315e-02, -7.18579193e+00],
                                  [-1.82219315e-02,  7.19516914e+00,  1.47607193e-01],
                                  [-7.18579193e+00,  1.47607193e-01,  2.10404208e+01]])

qfi_7n_com_3p_ent = np.array([[17.01203629,  0.09153202, -7.61818169],
  [ 0.09153202,  7.37398441, -0.31116093],
  [-7.61818169, -0.31116093, 20.93217285]])

qfi_7n_com_6p_CYC_ENT = np.array([[ 1.63263641e+01,  2.21848373e-01,  1.20209007e-01, -4.31209183e-02, -6.48994072e+00,  1.11232950e+01],
                                  [ 2.21848373e-01,  1.13786391e+01,  4.11964417e-01, -5.27368546e-02, -2.10018806e-01, -9.80548477e-02],
                                  [ 1.20209007e-01,  4.11964417e-01,  7.41915985e+00,  1.43238449e-02, -4.84241486e-02, -1.57814980e-01],
                                  [-4.31209183e-02, -5.27368546e-02,  1.43238449e-02,  7.59874916e+00, 1.17830200e-01, -1.54645157e-01],
                                  [-6.48994072e+00, -2.10018806e-01, -4.84241486e-02,  1.17830200e-01, 2.08668633e+01, -5.73490852e+00],
                                  [ 1.11232950e+01, -9.80548477e-02, -1.57814980e-01, -1.54645157e-01, -5.73490852e+00,  6.53437246e+01]])

qfi_7n_com_6p_ent = np.array([[ 1.72698076e+01, -1.24631004e-01,  2.46831818e-01,  9.75936127e-02, -6.55158543e+00,  1.58585221e+01],
  [-1.24631004e-01,  1.10905797e+01, -6.63769531e-02, -7.99212265e-02, -3.24820404e-01, -3.72205009e-01],
  [ 2.46831818e-01, -6.63769531e-02,  7.34590996e+00, -6.86698151e-02, -9.88104630e-02,  8.30954781e-01],
  [ 9.75936127e-02, -7.99212265e-02, -6.86698151e-02,  7.85045597e+00, 3.49448395e-02,  4.58073158e-01],
  [-6.55158543e+00, -3.24820404e-01, -9.88104630e-02,  3.49448395e-02, 2.10020381e+01, -6.22356758e+00],
  [ 1.58585221e+01, -3.72205009e-01,  8.30954781e-01,  4.58073158e-01, -6.22356758e+00,  6.27362177e+01]])

qfi_7n_com_9p_CYC_ENT = np.array([[ 1.70234671e+01,  2.01597977e-02, -1.31548271e-01, -7.92358017e-02, -1.09294128e-02,  9.57008362e-03, -6.29577808e+00,  1.19894876e+01, 2.67626476e+00],
                                  [ 2.01597977e-02,  1.01537922e+01, -2.06150055e-02, -6.00872040e-03, -2.03044128e-02, -3.43091965e-02,  1.40537643e-01, -8.75427551e-01, 1.87097736e+00],
                                  [-1.31548271e-01, -2.06150055e-02,  8.10907608e+00, -8.16449738e-02, 6.69148636e-02, -6.60194397e-03,  2.73462601e-01, -1.40891380e-01, 1.53601074e-02],
                                  [-7.92358017e-02, -6.00872040e-03, -8.16449738e-02,  7.54067188e+00, -9.58454132e-03,  2.52363968e-02,  2.27729607e-01, -2.10201836e-01, 1.80512619e-02],
                                  [-1.09294128e-02, -2.03044128e-02,  6.69148636e-02, -9.58454132e-03, 7.30344379e+00, -9.09798431e-02,  5.54767609e-02, -9.25172043e-02, -1.85341835e-01],
                                  [ 9.57008362e-03, -3.43091965e-02, -6.60194397e-03,  2.52363968e-02, -9.09798431e-02,  7.09344990e+00,  2.19923782e-02,  1.73066750e-01, -3.96496887e-01],
                                  [-6.29577808e+00,  1.40537643e-01,  2.73462601e-01,  2.27729607e-01, 5.54767609e-02,  2.19923782e-02,  2.08964480e+01, -6.57441017e+00, -6.91212082e-01],
                                  [ 1.19894876e+01, -8.75427551e-01, -1.40891380e-01, -2.10201836e-01, -9.25172043e-02,  1.73066750e-01, -6.57441017e+00,  6.60317496e+01, 1.88256107e+00],
                                  [ 2.67626476e+00,  1.87097736e+00,  1.53601074e-02,  1.80512619e-02, -1.85341835e-01, -3.96496887e-01, -6.91212082e-01,  1.88256107e+00, 3.87700134e+01]])

qfi_7n_com_9p_ent = np.array([[1.90646869e+01, -7.79838257e-01, -2.37170067e-01, -2.41487846e-01,  7.11612701e-02,  2.03210068e-02, -6.97088634e+00,  1.72476240e+01,
    3.00817463e+00],
  [-7.79838257e-01,  1.08205490e+01, -8.31989288e-03, -3.18125534e-01,  -1.02307510e-02,  1.40305939e-01,  2.09728622e-02,  6.07592392e-02,
    5.77149651e+00],
  [-2.37170067e-01, -8.31989288e-03,  9.50536560e+00, -1.34948692e-01,  2.62971115e-02, -1.21160660e-01,  2.82105637e-01, -1.04813766e+00,
   -4.27445869e-01],
  [-2.41487846e-01, -3.18125534e-01, -1.34948692e-01,  7.56736446e+00,  2.49254608e-02, -8.64850998e-02,  5.36349869e-01,  8.14741135e-02,
   -5.21873741e-01],
  [ 7.11612701e-02, -1.02307510e-02,  2.62971115e-02,  2.49254608e-02,  8.27198185e+00, -1.16442528e-01,  9.97914124e-02,  2.32399406e-01,
    1.42164154e-01],
  [ 2.03210068e-02,  1.40305939e-01, -1.21160660e-01, -8.64850998e-02,  -1.16442528e-01,  7.36787582e+00, -6.79119492e-02,  1.42154388e-01,
    1.03389587e-01],
  [-6.97088634e+00,  2.09728622e-02,  2.82105637e-01,  5.36349869e-01,  9.97914124e-02, -6.79119492e-02,  2.10993729e+01, -7.78698280e+00,
   -1.53604385e+00],
  [ 1.72476240e+01,  6.07592392e-02, -1.04813766e+00,  8.14741135e-02,  2.32399406e-01,  1.42154388e-01, -7.78698280e+00,  6.58518772e+01,
    6.80752892e+00],
  [ 3.00817463e+00,  5.77149651e+00, -4.27445869e-01, -5.21873741e-01,  1.42164154e-01,  1.03389587e-01, -1.53604385e+00,  6.80752892e+00,
    4.08948115e+01]])


# Create a list of matrices and their titles
qfi_matrices = [qfi_7n_com_3p_CYC_ENT, qfi_7n_com_3p_ent, qfi_7n_com_6p_CYC_ENT, qfi_7n_com_6p_ent, qfi_7n_com_9p_CYC_ENT, qfi_7n_com_9p_ent]
titles = ['QFI 3p CYC-ENT', 'QFI 3p COM-ENT', 'QFI 6p CYC-ENT', 'QFI 6p COM-ENT', 'QFI 9p CYC-ENT', 'QFI 9p COM-ENT']

# Set up the figure and axes
fig, axes = plt.subplots(3, 2, figsize=(13, 10))

# Use a single color bar for all subplots
vmin = min([matrix.min() for matrix in qfi_matrices])
vmax = max([matrix.max() for matrix in qfi_matrices])

# Plot each matrix as a heatmap
for i, ax in enumerate(axes.flat):
    sns.heatmap(qfi_matrices[i], ax=ax, annot=True, cmap='crest', linewidth=0.5, vmin=vmin, vmax=vmax, cbar=i == 0,
                cbar_ax=None if i else fig.add_axes([.91, .3, .03, .4]))
    ax.set_title(titles[i])

# Adjust layout
plt.tight_layout(rect=[0, 0, .9, 1])
plt.show()

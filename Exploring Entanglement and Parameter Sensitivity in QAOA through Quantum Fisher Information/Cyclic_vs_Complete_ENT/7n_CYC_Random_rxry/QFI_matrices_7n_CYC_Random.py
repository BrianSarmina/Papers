import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

qfi_7n_cyc_3p_CYC_ENT = np.array([[ 6.47861835,  0.03111504, -0.0082122 ],
                                  [ 0.03111504,  7.6596632,   0.02512947],
                                  [-0.0082122,   0.02512947,  6.99665279]])

qfi_7n_cyc_3p_ent = np.array([[ 5.9667395, 0.02623341, -0.02956547],
  [ 0.02623341, 11.76406609, -0.25032291],
  [-0.02956547, -0.25032291,  6.99128323]])

qfi_7n_cyc_6p_CYC_ENT = np.array([[ 6.03258522e+00, -2.83264542e-02, -1.16460800e-02, -2.53000641e-02, -1.25593567e-02,  2.23029129e+00],
                                  [-2.83264542e-02,  8.12035275e+00,  3.63561516e-01, -5.33815384e-02, -4.57494736e-02,  1.07209358e-01],
                                  [-1.16460800e-02,  3.63561516e-01,  7.87402077e+00,  1.57016068e-01, 3.42247009e-03,  9.50138092e-02],
                                  [-2.53000641e-02, -5.33815384e-02,  1.57016068e-01,  7.45027172e+00, -2.96329880e-02, -8.55084610e-02],
                                  [-1.25593567e-02, -4.57494736e-02,  3.42247009e-03, -2.96329880e-02, 6.97868454e+00, -2.41374969e-03],
                                  [ 2.23029129e+00,  1.07209358e-01,  9.50138092e-02, -8.55084610e-02, -2.41374969e-03,  8.73568241e+00]])

qfi_7n_cyc_6p_ent = np.array([[ 5.71608055,  0.0370662,  0.02744133,  0.04382603, -0.01295311,
    2.11360294],
  [ 0.03706627,  8.26294064, -0.05994015, -0.18731403, -0.30653099,
   -0.143545  ],
  [ 0.02744133, -0.05994015,  9.95048832, -0.02297832, -0.53238647,
    0.23935432],
  [ 0.04382603, -0.18731403, -0.02297832,  7.674221,   -0.04835262,
    0.20729824],
  [-0.01295311, -0.30653099, -0.53238647, -0.04835262,  6.96408592,
    0.28418243],
  [ 2.11360294, -0.143545,    0.23935432,  0.20729824,  0.28418243,
    8.33384026]])

qfi_7n_cyc_9p_CYC_ENT = np.array([[ 5.76165855e+00, -1.90136604e-01,  1.35664635e-01, -1.26932144e-02, -6.04362488e-03,  9.87991333e-03,  3.17037964e-02,  2.16779697e+00, 2.39466858e-02],
                                  [-1.90136604e-01,  7.61002644e+00,  8.78373718e-02, -1.81302986e-01, -9.45478058e-02,  5.23089218e-02, -2.67028160e-01, -2.96921425e-01, 9.82801056e-01],
                                  [ 1.35664635e-01,  8.78373718e-02,  7.54326881e+00, -2.58630333e-01, -5.59894943e-02, -2.36593246e-02,  2.48596191e-02,  9.27486420e-02, 1.65102158e-01],
                                  [-1.26932144e-02, -1.81302986e-01, -2.58630333e-01,  7.60783676e+00, 1.24437332e-01,  2.93062210e-02, -3.26068878e-03, -5.37520981e-02, -2.92598228e-01],
                                  [-6.04362488e-03, -9.45478058e-02, -5.59894943e-02,  1.24437332e-01, 7.38937992e+00,  1.02222900e-01,  8.66714478e-03,  5.53331375e-02, -6.33148193e-02],
                                  [ 9.87991333e-03,  5.23089218e-02, -2.36593246e-02,  2.93062210e-02, 1.02222900e-01,  7.06977013e+00, -1.22137680e-01, -5.86568451e-02, 8.34204102e-02],
                                  [ 3.17037964e-02, -2.67028160e-01,  2.48596191e-02, -3.26068878e-03, 8.66714478e-03, -1.22137680e-01,  6.95526405e+00,  3.92275238e-02, 2.18906441e-01],
                                  [ 2.16779697e+00, -2.96921425e-01,  9.27486420e-02, -5.37520981e-02, 5.53331375e-02, -5.86568451e-02,  3.92275238e-02,  8.94917191e+00, -9.49300766e-02],
                                  [ 2.39466858e-02,  9.82801056e-01,  1.65102158e-01, -2.92598228e-01, -6.33148193e-02,  8.34204102e-02,  2.18906441e-01, -9.49300766e-02, 7.50230835e+00]])

qfi_7n_cyc_9p_ent = np.array([[6.33026489, -0.12694027,  0.15966728, -0.08890995,  0.18365658,  -0.12533787,  0.0166478,   2.41473671,  0.26389034],
  [-0.12694027,  7.99340645,  0.01304062, -0.11730377,  0.10192394,  0.12953125, -0.04376427,  0.10912014,  3.69550499],
  [ 0.15966728,  0.01304062,  7.77603729, -0.10861378,  0.23701084,  -0.15582138,  0.09519341, -0.286791,   -0.01263924],
  [-0.08890995, -0.11730377, -0.10861378, 11.18613583,  0.20118538,  0.03104397,  0.26186512,  0.09021233, -0.18523243],
  [ 0.18365658,  0.10192394,  0.23701084,  0.20118538,  8.38431404,  0.05012871, -0.1542841,   0.04511917, -0.16834106],
  [-0.12533787,  0.12953125, -0.15582138,  0.03104397,  0.05012871,  7.31296448,  0.13388508, -0.06275475,  0.06815079],
  [ 0.0166478,  -0.04376427,  0.09519341,  0.26186512, -0.1542841,  0.13388508,  7.02782619, -0.24823376, -0.11345066],
  [ 2.41473671,  0.10912014, -0.286791,    0.09021233,  0.04511917,  -0.06275475, -0.24823376,  8.84862488,  0.66143021],
  [ 0.26389034,  3.69550499, -0.01263924, -0.18523243, -0.16834106,  0.06815079, -0.11345066,  0.66143021,  8.03479729]])

# Create a list of matrices and their titles
qfi_matrices = [qfi_7n_cyc_3p_CYC_ENT, qfi_7n_cyc_3p_ent, qfi_7n_cyc_6p_CYC_ENT, qfi_7n_cyc_6p_ent, qfi_7n_cyc_9p_CYC_ENT, qfi_7n_cyc_9p_ent]
titles = ['QFI 3p CYC-ENT', 'QFI 3p COM-ENT', 'QFI 6p CYC-ENT', 'QFI 6p COM-ENT', 'QFI 9p CYC-ENT', 'QFI 9p COM-ENT']

# Set up the figure and axes
fig, axes = plt.subplots(3, 2, figsize=(13, 10))

# Use a single color bar for all subplots
vmin = min([matrix.min() for matrix in qfi_matrices])
vmax = max([matrix.max() for matrix in qfi_matrices])

# Plot each matrix as a heatmap
for i, ax in enumerate(axes.flat):
    sns.heatmap(qfi_matrices[i], ax=ax, annot=True, cmap='crest', linewidth=0.5, vmin=vmin, vmax=vmax, cbar=i == 0,
                cbar_ax=None if i else fig.add_axes([.91, .3, .03, .4]))
    ax.set_title(titles[i])

# Adjust layout
plt.tight_layout(rect=[0, 0, .9, 1])
plt.show()

##plt.imshow(qfi_4n_cyc_6p_ent)
##data = np.array(qfi_4n_cyc_6p_ent, dtype='float16')
##for i in range(len(qfi_4n_cyc_6p_ent)):
##  for j in range(len(qfi_4n_cyc_6p_ent)):
##      plt.annotate(str(data[i][j]), xy=(j, i), ha='center', va='center', color='white')
##plt.colorbar()

#plt.show()
